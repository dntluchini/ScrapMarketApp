{
  "proyecto": "ScrapMarket App - Comparador de Precios",
  "objetivo": "App mÃ³vil multiplataforma que consume datos scrapeados desde supermercados VTEX (Carrefour, Jumbo, Disco, Vea) para comparar precios, detectar descuentos y configurar alertas de precios.",
  "nivel_de_experiencia": "Conocimientos sÃ³lidos en programaciÃ³n, APIs y automatizaciones (n8n). Aprendiendo desarrollo mÃ³vil con React Native/Expo.",
  "estado_actual": {
    "fase": "Desarrollo Avanzado - Funcionalidades Core + UX Optimizadas + Carrito de Compras + IntegraciÃ³n Completa",
    "version": "v1.4.0-beta",
    "ultima_actualizacion": "12 Noviembre 2025"
  },
  "arquitectura_implementada": {
    "frontend": {
      "framework": "React Native con Expo SDK 54",
      "lenguaje": "TypeScript con strict mode",
      "navegacion": "React Navigation v7 (Bottom Tabs + Stack Navigator)",
      "estructura": "Arquitectura de servicios con separaciÃ³n de responsabilidades",
      "estado": "useState/useEffect (prÃ³ximo: Redux Toolkit)",
      "error_handling": "ErrorBoundary implementado a nivel de App"
    },
    "backend": {
      "automatizacion": "n8n (Docker local)",
      "base_datos": "Supabase (PostgreSQL)",
      "scraping": "VTEX API (no HTML scraping)",
      "endpoints": "Webhooks REST personalizados",
      "cache_predictivo": "Sistema de cache automÃ¡tico cada 6 horas"
    },
    "infraestructura": {
      "desarrollo": "Docker local (n8n)",
      "base_datos": "Supabase Cloud",
      "deployment": "Pendiente (Railway/VPS)"
    }
  },
  "funcionalidades_core": {
    "implementadas": [
      "âœ… BÃºsqueda de productos en tiempo real",
      "âœ… Scraping automÃ¡tico cuando faltan resultados",
      "âœ… AgrupaciÃ³n inteligente de productos por EAN/marca/peso",
      "âœ… VisualizaciÃ³n de precios por supermercado",
      "âœ… NavegaciÃ³n entre pantallas",
      "âœ… Manejo de estados de carga y errores",
      "âœ… Sistema de cache predictivo para productos populares",
      "âœ… RotaciÃ³n inteligente de productos por categorÃ­as",
      "âœ… Modo ahorro de datos",
      "âœ… BÃºsqueda solo en base de datos",
      "âœ… Pull-to-refresh nativo",
      "âœ… Carga progresiva con skeleton loading",
      "âœ… Algoritmo de relevancia mejorado",
      "âœ… Error Boundary para manejo de errores",
      "âœ… Historial de precios (servicio implementado)",
      "âœ… Sistema de alertas de precios (servicio implementado)",
      "âœ… Pantalla de detalles de producto con historial",
      "âœ… ConfiguraciÃ³n de ambiente por entornos (dev/staging/prod)",
      "âœ… Carrito de compras completo con gestiÃ³n de cantidades",
      "âœ… AgrupaciÃ³n de productos por supermercado en el carrito",
      "âœ… RedirecciÃ³n a sitios de supermercados con parÃ¡metros correctos",
      "âœ… IntegraciÃ³n de addToCartLink desde base de datos",
      "âœ… Badge animado en tab de carrito",
      "âœ… Modales personalizados para confirmaciones",
      "âœ… BÃºsqueda automÃ¡tica desde productos populares",
      "âœ… CapitalizaciÃ³n correcta de marcas y productos",
      "âœ… Manejo robusto de imÃ¡genes en mÃºltiples formatos"
    ],
    "avanzadas": [
      "âœ… CapitalizaciÃ³n automÃ¡tica de marcas",
      "âœ… Formato de nombres: 'Marca - Producto'",
      "âœ… AgrupaciÃ³n por similitud de nombres",
      "âœ… DetecciÃ³n automÃ¡tica de packs de productos",
      "âœ… Sistema de categorÃ­as semÃ¡nticas",
      "âœ… RotaciÃ³n temporal de productos populares",
      "âœ… Carga paralela con timeouts",
      "âœ… Logging estructurado",
      "âœ… Sistema de configuraciÃ³n por ambiente",
      "âœ… Componente ErrorBoundary con UI de error",
      "âœ… SearchErrorBoundary especÃ­fico para bÃºsquedas",
      "âœ… Sistema de listeners/observers para reacti vidad del carrito",
      "âœ… ActualizaciÃ³n dinÃ¡mica de qty en URLs de supermercados",
      "âœ… Modales personalizados con mejor UX que Alert nativo",
      "âœ… Animaciones en badge del carrito (bounce effect)",
      "âœ… Persistencia de carrito con sistema de listeners",
      "âœ… BÃºsqueda directa en DB con bypass de relevancia",
      "âœ… Manejo de mÃºltiples formatos JSON desde n8n",
      "âœ… GestiÃ³n de lifecycle del carousel (pause/resume)"
    ],
    "pendientes_integracion": [
      "âŒ› Integrar AlertsScreen en navegaciÃ³n principal",
      "âŒ› Integrar HistoryScreen en navegaciÃ³n principal",
      "âŒ› Conectar alertas con notificaciones push",
      "âŒ› AutenticaciÃ³n de usuarios",
      "âŒ› Modo offline completo",
      "âŒ› Notificaciones push",
      "âŒ› Redux Toolkit para estado global",
      "âŒ› Instalar e implementar AsyncStorage para cache local",
      "âŒ› Instalar e implementar Zod para validaciÃ³n de esquemas"
    ]
  },
  "tecnologias_y_herramientas": {
    "frontend": {
      "react_native": "Framework principal (v0.81.5)",
      "expo": "SDK 54 para desarrollo rÃ¡pido",
      "typescript": "Type safety y mejor DX (strict mode)",
      "react_navigation": "v7 - Bottom Tabs + Stack Navigator",
      "expo_secure_store": "Almacenamiento seguro (instalado)",
      "async_storage": "Cache local (pendiente instalaciÃ³n)",
      "zod": "ValidaciÃ³n de esquemas (pendiente instalaciÃ³n)",
      "react": "v19.1.0"
    },
    "backend": {
      "n8n": "AutomatizaciÃ³n y scraping",
      "supabase": "Base de datos PostgreSQL",
      "vtex_api": "API de supermercados",
      "docker": "ContainerizaciÃ³n de n8n",
      "postgresql": "Base de datos con categorÃ­as"
    },
    "desarrollo": {
      "context7_mcp": "DocumentaciÃ³n en tiempo real",
      "git_flow": "Control de versiones",
      "conventional_commits": "Mensajes de commit estandarizados"
    }
  },
  "estructura_del_proyecto": {
    "ScrapMarketApp/": {
      "src/": {
        "components/": "Componentes reutilizables (ProductCard, SearchFilters, PopularProducts, etc.)",
        "screens/": "Pantallas principales (Search, Home, Alerts, etc.)",
        "services/": "LÃ³gica de negocio (searchService, productGroupingService, n8nMcpService)",
        "navigation/": "ConfiguraciÃ³n de navegaciÃ³n",
        "types/": "Interfaces TypeScript",
        "config/": "ConfiguraciÃ³n de ambiente y productos populares",
        "hooks/": "Custom React hooks",
        "utils/": "Utilidades (logger, validation, cache, productNameUtils)"
      },
      "assets/": "ImÃ¡genes y recursos",
      "docs/": "DocumentaciÃ³n tÃ©cnica y guÃ­as de implementaciÃ³n"
    },
    "archivos_raiz": {
      "context.json": "ConfiguraciÃ³n del proyecto (este archivo)",
      "simulador_precios_app.html": "Prototipo funcional para testing"
    }
  },
  "workflows_n8n_activos": {
    "definitive_scraper_complete_optimized": {
      "descripcion": "Workflow principal que maneja bÃºsqueda en BD + scraping automÃ¡tico + respuesta unificada",
      "tecnologias": [
        "React Native",
        "n8n webhooks",
        "PostgreSQL",
        "VTEX API"
      ],
      "endpoint": "/webhook/search-products-complete",
      "nodos": 16,
      "estado": "âœ… ACTIVO"
    },
    "search_in_db": {
      "descripcion": "Workflow para bÃºsqueda directa en base de datos sin scraping",
      "tecnologias": [
        "PostgreSQL",
        "n8n webhooks"
      ],
      "endpoint": "/webhook/search-in-db",
      "nodos": 4,
      "estado": "âœ… ACTIVO"
    },
    "add_product_to_db": {
      "descripcion": "Workflow para guardar productos scrapeados en base de datos",
      "tecnologias": [
        "PostgreSQL",
        "n8n workflows"
      ],
      "endpoint": "/webhook/add-product-to-db",
      "nodos": 16,
      "estado": "âœ… ACTIVO"
    },
    "cache_predictivo_productos_populares": {
      "descripcion": "Workflow automÃ¡tico que cachea productos populares cada 6 horas",
      "tecnologias": [
        "Cron Trigger",
        "PostgreSQL",
        "HTTP Requests"
      ],
      "nodos": 10,
      "estado": "âœ… ACTIVO",
      "frecuencia": "Cada 6 horas"
    },
    "test_cache_predictivo_manual": {
      "descripcion": "Workflow de prueba para testing manual del cache predictivo",
      "tecnologias": [
        "Webhook Trigger",
        "HTTP Requests"
      ],
      "nodos": 6,
      "estado": "âœ… ACTIVO"
    }
  },
  "funcionalidades_implementadas": {
    "scraping_tiempo_real": {
      "descripcion": "Polling cada 5s â†’ Muestra resultados parciales â†’ Guarda automÃ¡ticamente en BD",
      "tecnologias": [
        "n8n workflows",
        "Client-side polling",
        "Real-time updates"
      ],
      "ubicacion": "SearchScreen.tsx + searchService.ts",
      "estado": "âœ… Funcional"
    },
    "agrupacion_productos": {
      "descripcion": "Agrupa por EAN + peso + marca â†’ Formato 'Marca - Producto' â†’ Capitaliza marcas",
      "tecnologias": [
        "TypeScript algorithms",
        "Product similarity",
        "Brand normalization"
      ],
      "ubicacion": "productGroupingService.ts",
      "estado": "âœ… Funcional"
    },
    "guardado_automatico": {
      "descripcion": "Guardar productos scrapeados automÃ¡ticamente en BD",
      "tecnologias": [
        "n8n add_product_to_db workflow",
        "Automatic triggers"
      ],
      "ubicacion": "SearchScreen.tsx + n8n workflow",
      "estado": "âœ… Funcional"
    },
    "cache_predictivo": {
      "descripcion": "Sistema automÃ¡tico de cache para productos populares con rotaciÃ³n por categorÃ­as",
      "tecnologias": [
        "n8n cron jobs",
        "PostgreSQL",
        "AsyncStorage"
      ],
      "ubicacion": "PopularProducts.tsx + n8n workflows",
      "estado": "âœ… Funcional"
    },
    "rotacion_categorias": {
      "descripcion": "RotaciÃ³n inteligente de productos populares basada en categorÃ­as semÃ¡nticas y horarios",
      "tecnologias": [
        "TypeScript algorithms",
        "Time-based logic",
        "Semantic categories"
      ],
      "ubicacion": "PopularProducts.tsx + popularProductsConfig.ts",
      "estado": "âœ… Funcional"
    },
    "modo_ahorro_datos": {
      "descripcion": "Modo que prioriza bÃºsquedas en BD y reduce requests de scraping",
      "tecnologias": [
        "React Native state",
        "Conditional API calls"
      ],
      "ubicacion": "SearchScreen.tsx + searchService.ts",
      "estado": "âœ… Funcional"
    },
    "carga_progresiva": {
      "descripcion": "Carga progresiva con skeleton loading y pull-to-refresh",
      "tecnologias": [
        "React Native",
        "Skeleton components",
        "RefreshControl"
      ],
      "ubicacion": "SearchScreen.tsx + ProductSkeleton.tsx",
      "estado": "âœ… Funcional"
    },
    "error_boundary": {
      "descripcion": "Error Boundary implementado a nivel de aplicaciÃ³n y especÃ­fico para bÃºsquedas",
      "tecnologias": [
        "React Error Boundaries",
        "Error UI personalizada"
      ],
      "ubicacion": "ErrorBoundary.tsx + SearchErrorBoundary.tsx",
      "estado": "âœ… Funcional"
    },
    "historial_precios": {
      "descripcion": "Servicio de historial de precios con cÃ¡lculo de promedios y rangos",
      "tecnologias": [
        "n8n workflows",
        "PostgreSQL",
        "TypeScript services"
      ],
      "ubicacion": "historyService.ts + ProductDetailsScreen.tsx",
      "estado": "âœ… Funcional (pendiente integraciÃ³n en navegaciÃ³n)"
    },
    "sistema_alertas": {
      "descripcion": "Servicio de alertas de precios con CRUD completo",
      "tecnologias": [
        "n8n workflows",
        "PostgreSQL",
        "TypeScript services"
      ],
      "ubicacion": "alertService.ts + AlertsScreen.tsx",
      "estado": "âœ… Funcional (pendiente integraciÃ³n en navegaciÃ³n)"
    },
    "configuracion_ambiente": {
      "descripcion": "Sistema de configuraciÃ³n por ambiente (dev/staging/prod)",
      "tecnologias": [
        "expo-constants",
        "Environment variables",
        "TypeScript interfaces"
      ],
      "ubicacion": "config/environment.ts",
      "estado": "âœ… Funcional"
    },
    "carrito_compras": {
      "descripcion": "Sistema completo de carrito con gestiÃ³n de productos, cantidades y redirecciÃ³n a supermercados",
      "tecnologias": [
        "React Native state management",
        "Observer pattern (listeners)",
        "Animated API",
        "Custom modals",
        "URL manipulation"
      ],
      "caracteristicas": [
        "Agregar productos con cantidades personalizadas",
        "Actualizar cantidades con controles +/-",
        "Eliminar productos individuales",
        "Vaciar carrito completo o por supermercado",
        "Badge animado con bounce effect",
        "AgrupaciÃ³n automÃ¡tica por supermercado",
        "RedirecciÃ³n a web del supermercado con qty correcto",
        "Modales personalizados para confirmaciones",
        "Sistema de listeners para reactividad",
        "Persistencia preparada para AsyncStorage"
      ],
      "ubicacion": "CartScreen.tsx + cartService.ts + useCart.ts + AnimatedCartBadge.tsx",
      "estado": "âœ… Funcional"
    },
    "busqueda_directa_db": {
      "descripcion": "BÃºsqueda directa en base de datos sin scraping, con bypass de filtros de relevancia",
      "tecnologias": [
        "n8n webhook",
        "PostgreSQL",
        "React Navigation params"
      ],
      "caracteristicas": [
        "InvocaciÃ³n desde productos populares",
        "Bypass de filtro de relevancia",
        "Manejo de mÃºltiples formatos JSON",
        "IntegraciÃ³n con SearchScreen",
        "Fallback a scraping si no hay resultados"
      ],
      "endpoint": "/webhook/search-in-db",
      "ubicacion": "SearchScreen.tsx + n8nMcpService.ts",
      "estado": "âœ… Funcional"
    }
  },
  "mejoras_recientes": {
    "arquitectura": [
      "âœ… Limpieza de archivos no utilizados (800+ lÃ­neas eliminadas)",
      "âœ… UnificaciÃ³n de componentes de producto",
      "âœ… Mejora en manejo de estados",
      "âœ… OptimizaciÃ³n de polling de scraping",
      "âœ… ImplementaciÃ³n de sistema de cache predictivo",
      "âœ… Arquitectura de categorÃ­as semÃ¡nticas",
      "âœ… Sistema de observers/listeners para carrito",
      "âœ… IntegraciÃ³n completa de addToCartLink desde BD",
      "âœ… EliminaciÃ³n de useProductModal.ts (no utilizado)"
    ],
    "funcionalidad": [
      "âœ… CorrecciÃ³n de agrupaciÃ³n de productos",
      "âœ… ImplementaciÃ³n de capitalizaciÃ³n de marcas",
      "âœ… Mejora en detecciÃ³n de packs",
      "âœ… OptimizaciÃ³n de timeouts y reintentos",
      "âœ… Sistema de rotaciÃ³n de productos populares",
      "âœ… Algoritmo de relevancia mejorado",
      "âœ… Modo ahorro de datos implementado",
      "âœ… Carrito de compras completo con gestiÃ³n de cantidades",
      "âœ… RedirecciÃ³n a supermercados con parÃ¡metros correctos",
      "âœ… BÃºsqueda automÃ¡tica desde productos populares",
      "âœ… Bypass de filtros de relevancia para DB directa"
    ],
    "calidad_codigo": [
      "âœ… EliminaciÃ³n de cÃ³digo duplicado",
      "âœ… Mejora en TypeScript interfaces",
      "âœ… OptimizaciÃ³n de imports y exports",
      "âœ… DocumentaciÃ³n actualizada",
      "âœ… ValidaciÃ³n de datos con Zod",
      "âœ… Logging estructurado implementado",
      "âœ… Manejo de errores mejorado",
      "âœ… Manejo robusto de mÃºltiples formatos JSON",
      "âœ… Debugging extensivo con console.log estructurado"
    ],
    "ux_ui": [
      "âœ… Skeleton loading para mejor UX",
      "âœ… Pull-to-refresh nativo",
      "âœ… Carga progresiva de productos",
      "âœ… Indicadores de estado mejorados",
      "âœ… RotaciÃ³n visual de productos populares",
      "âœ… Badges de 'MEJOR PRECIO'",
      "âœ… CategorÃ­as con iconos y colores",
      "âœ… Badge animado del carrito con bounce effect",
      "âœ… Modales personalizados reemplazando Alert.alert",
      "âœ… Controles de cantidad +/- intuitivos",
      "âœ… CapitalizaciÃ³n correcta de marcas con artÃ­culos",
      "âœ… Carousel con lifecycle management (pause/resume)"
    ],
    "integracion_backend": [
      "âœ… MigraciÃ³n de seller_name y add_to_cart_link a reg_prices",
      "âœ… ModificaciÃ³n de queries SQL para popular_products",
      "âœ… AgrupaciÃ³n de productos en n8n por similitud",
      "âœ… ExtracciÃ³n correcta de addToCartLink por supermercado",
      "âœ… Manejo de mÃºltiples formatos de respuesta desde n8n",
      "âœ… IntegraciÃ³n de search-in-db endpoint"
    ]
  },
  "configuracion_actual": {
    "desarrollo": {
      "n8n_url": "http://192.168.1.99:5678",
      "supabase_url": "https://fuyytpcqjxhoermrngkm.supabase.co",
      "expo_sdk": "54",
      "typescript": "Configurado con strict mode",
      "node_version": "18+",
      "react_native_version": "0.81.5",
      "react_navigation_version": "v7"
    },
    "endpoints_n8n": {
      "search_products_complete": "/webhook/search-products-complete (definitive_scraper_complete_optimized)",
      "search_in_db": "/webhook/search-in-db (search_in_db)",
      "add_product_to_db": "/webhook/add-product-to-db (add_product_to_db)",
      "cache_predictivo": "Cron job cada 6 horas (cache_predictivo_productos_populares)",
      "test_cache": "/webhook/test-cache-predictivo (test_cache_predictivo_manual)"
    },
    "base_datos": {
      "tabla_products": "Incluye columnas de categorÃ­as (categories, primary_category, main_category, etc.)",
      "tabla_reg_prices": "Precios histÃ³ricos por supermercado",
      "tabla_supermarket": "InformaciÃ³n de supermercados",
      "indices": "Optimizados para bÃºsquedas por categorÃ­as y relevancia"
    }
  },
  "categorias_semanticas": {
    "carnes_pescados": {
      "nombre": "Carnes y pescados",
      "icono": "ğŸ¥©",
      "color": "#e74c3c",
      "productos": [
        "pollo",
        "carne",
        "pescado",
        "cerdo",
        "pavo",
        "cordero"
      ]
    },
    "lacteos": {
      "nombre": "LÃ¡cteos",
      "icono": "ğŸ¥›",
      "color": "#3498db",
      "productos": [
        "leche",
        "yogur",
        "queso",
        "manteca",
        "crema"
      ]
    },
    "frutas_verduras": {
      "nombre": "Frutas y verduras",
      "icono": "ğŸ",
      "color": "#27ae60",
      "productos": [
        "manzana",
        "banana",
        "tomate",
        "lechuga",
        "zanahoria"
      ]
    },
    "bebidas": {
      "nombre": "Bebidas",
      "icono": "ğŸº",
      "color": "#f39c12",
      "productos": [
        "coca cola",
        "agua",
        "jugo",
        "cerveza",
        "vino"
      ]
    },
    "panaderia": {
      "nombre": "PanaderÃ­a",
      "icono": "ğŸ",
      "color": "#d35400",
      "productos": [
        "pan",
        "galletas",
        "tortas",
        "facturas"
      ]
    },
    "limpieza": {
      "nombre": "Limpieza",
      "icono": "ğŸ§¼",
      "color": "#9b59b6",
      "productos": [
        "detergente",
        "jabÃ³n",
        "papel",
        "limpiador"
      ]
    }
  },
  "algoritmo_relevancia": {
    "descripcion": "Sistema mejorado de relevancia que evita resultados irrelevantes",
    "caracteristicas": [
      "âœ… BÃºsqueda por palabras completas con regex",
      "âœ… PenalizaciÃ³n por palabras irrelevantes",
      "âœ… PriorizaciÃ³n por categorÃ­as semÃ¡nticas",
      "âœ… Coincidencias exactas tienen mÃ¡xima prioridad",
      "âœ… Filtrado por longitud mÃ­nima de palabras",
      "âœ… Fallback para coincidencias parciales"
    ],
    "configuracion": {
      "min_relevance": 25,
      "min_word_length": 2,
      "exact_match_bonus": 100,
      "category_bonus": 50,
      "irrelevant_penalty": -100
    }
  },
  "prÃ³ximos_pasos": {
    "alta_prioridad": [
      "ğŸ”´ Integrar AlertsScreen en navegaciÃ³n principal",
      "ğŸ”´ Integrar HistoryScreen en navegaciÃ³n principal",
      "ğŸ”´ Conectar alertas con notificaciones push",
      "ğŸ”´ Implementar Redux Toolkit para estado global",
      "ğŸ”´ Instalar e implementar AsyncStorage para cache local",
      "ğŸ”´ Instalar e implementar Zod para validaciÃ³n de esquemas"
    ],
    "media_prioridad": [
      "ğŸŸ¡ Crear API Gateway para abstraer n8n",
      "ğŸŸ¡ Implementar modo offline completo",
      "ğŸŸ¡ Agregar Analytics y mÃ©tricas",
      "ğŸŸ¡ Crear Tests unitarios y de integraciÃ³n",
      "ğŸŸ¡ Optimizar performance para dispositivos antiguos"
    ],
    "baja_prioridad": [
      "ğŸŸ¢ Implementar autenticaciÃ³n de usuarios",
      "ğŸŸ¢ Agregar sistema de favoritos",
      "ğŸŸ¢ Crear comparador de listas de compras",
      "ğŸŸ¢ Implementar CI/CD",
      "ğŸŸ¢ Agregar internacionalizaciÃ³n"
    ]
  },
  "documentacion_disponible": {
    "tecnica": [
      "ScrapMarketApp/README.md - DocumentaciÃ³n principal del proyecto",
      "ScrapMarketApp/DEPLOYMENT.md - GuÃ­a de deployment",
      "ScrapMarketApp/docs/MCP_SETUP.md - ConfiguraciÃ³n MCP",
      "ScrapMarketApp/docs/cache_predictive_workflow.md - Workflow de cache predictivo",
      "ScrapMarketApp/docs/setup_predictive_cache_db.sql - Scripts de BD",
      "ScrapMarketApp/docs/GUIA_IMPLEMENTACION_CACHE.md - GuÃ­a de implementaciÃ³n",
      "ScrapMarketApp/.github/CONTRIBUTING.md - GuÃ­a de contribuciÃ³n"
    ],
    "funcional": [
      "simulador_precios_app.html - Prototipo funcional para testing",
      "context.json - Este archivo con toda la informaciÃ³n del proyecto"
    ],
    "workflows_n8n": [
      "definitive_scraper_complete_optimized - Workflow principal (ACTIVO)",
      "search_in_db - BÃºsqueda en BD (ACTIVO)",
      "add_product_to_db - Guardar productos (ACTIVO)",
      "cache_predictivo_productos_populares - Cache automÃ¡tico (ACTIVO)",
      "test_cache_predictivo_manual - Testing manual (ACTIVO)"
    ]
  },
  "archivos_importantes": {
    "componentes_principales": [
      "src/screens/SearchScreen.tsx - Pantalla principal de bÃºsqueda con integraciÃ³n completa",
      "src/screens/HomeScreen.tsx - Pantalla de inicio con productos populares",
      "src/screens/CartScreen.tsx - Pantalla de carrito de compras con gestiÃ³n completa",
      "src/screens/ProductDetailsScreen.tsx - Detalles de producto con historial",
      "src/screens/ProfileScreen.tsx - Pantalla de perfil",
      "src/screens/AlertsScreen.tsx - Pantalla de alertas (pendiente integraciÃ³n)",
      "src/screens/HistoryScreen.tsx - Pantalla de historial (pendiente integraciÃ³n)",
      "src/components/PopularProducts.tsx - Componente de productos populares con rotaciÃ³n y lifecycle",
      "src/components/PopularProductCard.tsx - Tarjeta individual del carousel con capitalizaciÃ³n de marcas",
      "src/components/GroupedProductCard.tsx - Tarjeta de producto agrupado",
      "src/components/ProductCard/SupermarketItem.tsx - Item individual de supermercado con modal personalizado",
      "src/components/AnimatedCartBadge.tsx - Badge animado para el tab del carrito",
      "src/components/ProductSkeleton.tsx - Skeleton loading",
      "src/components/ProgressIndicator.tsx - Indicador de progreso",
      "src/components/ErrorBoundary.tsx - Error Boundary principal",
      "src/components/SearchErrorBoundary.tsx - Error Boundary para bÃºsquedas",
      "src/navigation/AppNavigator.tsx - ConfiguraciÃ³n de navegaciÃ³n con Cart tab"
    ],
    "servicios": [
      "src/services/searchService.ts - Servicio principal de bÃºsqueda",
      "src/services/cartService.ts - Servicio de carrito con sistema de listeners",
      "src/services/productGroupingService.ts - AgrupaciÃ³n de productos con addToCartLink",
      "src/services/n8nMcpService.ts - ComunicaciÃ³n con n8n (incluye search-in-db)",
      "src/services/historyService.ts - Servicio de historial de precios",
      "src/services/alertService.ts - Servicio de alertas de precios",
      "src/config/environment.ts - ConfiguraciÃ³n por ambiente"
    ],
    "hooks": [
      "src/hooks/useCart.ts - Custom hook para reactividad del carrito"
    ],
    "configuracion": [
      "src/config/popularProductsConfig.ts - ConfiguraciÃ³n de productos populares",
      "src/types/index.ts - Interfaces TypeScript centralizadas",
      "tsconfig.json - ConfiguraciÃ³n TypeScript con strict mode",
      "package.json - Dependencias y scripts"
    ]
  },
  "problemas_conocidos": {
    "resueltos": [
      "âœ… Error de tipos implÃ­citos en PopularProducts.tsx",
      "âœ… Variable dbOnlyMode no definida en SearchScreen.tsx",
      "âœ… Propiedades faltantes en GroupedProduct",
      "âœ… Referencias a canonname en GroupedProduct",
      "âœ… Algoritmo de relevancia demasiado estricto",
      "âœ… ExtracciÃ³n incorrecta de datos anidados en respuestas n8n",
      "âœ… Alert.alert no aparecÃ­a en SupermarketItem (reemplazado por modales)",
      "âœ… Badge del carrito duplicado (corregido en AppNavigator)",
      "âœ… Badge del carrito no se actualizaba (implementado sistema de listeners)",
      "âœ… AnimaciÃ³n del badge afectaba el fondo (corregido solo en nÃºmero)",
      "âœ… BotÃ³n vaciar carrito sin confirmaciÃ³n (agregado modal personalizado)",
      "âœ… addToCartLink siempre de Vea (corregido en SQL y n8n)",
      "âœ… Productos no agrupaban correctamente (refinado algoritmo de similitud)",
      "âœ… seller_name llegaba como null (corregido prioridad de extracciÃ³n)",
      "âœ… qty en URL no se actualizaba (implementado updateCartLinkQuantity)",
      "âœ… ImÃ¡genes no aparecÃ­an en popular products (agregado soporte imageurl minÃºscula)",
      "âœ… total_supermarkets incorrecto (corregido con size de Map)",
      "âœ… Carousel pausaba al cambiar de pantalla (implementado lifecycle con useIsFocused)",
      "âœ… Relevancia filtraba productos de DB (agregado bypass con fromDatabase flag)"
    ],
    "pendientes": [
      "ğŸŸ¦ OptimizaciÃ³n de performance en listas largas",
      "ğŸŸ¦ Manejo de errores de red mÃ¡s robusto",
      "ğŸŸ¦ ValidaciÃ³n de datos mÃ¡s estricta (requiere Zod)",
      "ğŸŸ¦ Integrar AlertsScreen y HistoryScreen en navegaciÃ³n principal",
      "ğŸŸ¦ Limpiar estructura duplicada (ScrapMarketApp/ScrapMarketApp/)",
      "ğŸŸ¦ Instalar dependencias faltantes (AsyncStorage, Zod)",
      "ğŸŸ¦ Remover console.log en producciÃ³n (250+ logs actualmente)",
      "ğŸŸ¦ Implementar persistencia del carrito con AsyncStorage",
      "ğŸŸ¦ Reducir uso de 'any' type (7 ocurrencias actuales)"
    ]
  },  
  "agentes_colaboradores": {
    "roles": {
      "arquitecto_software": {
        "objetivo": "Mantener una arquitectura mÃ³vil y de servicios escalable, modular y preparada para nuevas funcionalidades sin deuda tÃ©cnica.",
        "responsabilidades_clave": [
          "DiseÃ±ar y actualizar el mapa de capas entre pantallas, servicios TypeScript y workflows n8n.",
          "Definir contratos tipados y patrones de modularizaciÃ³n para componentes, hooks y servicios.",
          "Evaluar el impacto arquitectÃ³nico de nuevas features (alertas, historial, modo offline) y registrar ADR.",
          "Guiar la adopciÃ³n progresiva de Redux Toolkit y optimizaciones de rendimiento (memoizaciÃ³n, selectores).",
          "Supervisar mÃ©tricas de performance y proponer refactors preventivos para evitar renderizados costosos."
        ],
        "entregables_recurrentes": [
          "ADR y diagramas C4 de los flujos principales.",
          "Roadmap de evoluciÃ³n del estado global y caching.",
          "Checklist de performance para componentes crÃ­ticos.",
          "GuÃ­a de dependencias autorizadas y convenciones de imports."
        ],
        "herramientas_y_fuentes": [
          "Docs tÃ©cnicos en ScrapMarketApp/docs",
          "Excalidraw o Mermaid para diagramas",
          "Expo Diagnostics",
          "Supabase Schema Viewer"
        ],
        "criterios_de_finalizado": [
          "Componentes crÃ­ticos sin dependencias circulares.",
          "ADR aprobado por los demÃ¡s agentes antes de implementarse.",
          "Evidencia de pruebas de rendimiento en dispositivos objetivo."
        ],
        "puntos_de_colaboracion": [
          "Coordinar con Automatizaciones n8n los contratos de entrada y salida de cada webhook.",
          "Revisar con Ciberseguridad la exposiciÃ³n de datos sensibles en la arquitectura.",
          "Alinear con Commits y Estructura la organizaciÃ³n de carpetas y convenciones."
        ]
      },
      "especialista_ciberseguridad": {
        "objetivo": "Reducir la superficie de ataque en la app, n8n y Supabase mediante controles preventivos y detectivos.",
        "responsabilidades_clave": [
          "Realizar threat modeling de los workflows n8n y sus credenciales.",
          "DiseÃ±ar y verificar polÃ­ticas RLS en Supabase para proteger datos sensibles.",
          "Gestionar el ciclo de vida de secretos (rotaciÃ³n de API keys VTEX, tokens Expo, credenciales n8n).",
          "Automatizar escaneos de dependencias y revisiones OWASP Mobile/Backend.",
          "Definir playbooks de respuesta ante incidentes y checklist de hardening en mÃ³viles."
        ],
        "entregables_recurrentes": [
          "Informe trimestral de amenazas y recomendaciones.",
          "Checklist OWASP MASVS adaptado al proyecto.",
          "Procedimientos de respuesta y rotaciÃ³n de credenciales.",
          "Alertas configuradas para accesos sospechosos en Supabase y n8n."
        ],
        "herramientas_y_fuentes": [
          "Supabase Policies y Logs",
          "n8n Credential Manager",
          "OWASP MASVS y MASTG",
          "npm audit o Snyk"
        ],
        "criterios_de_finalizado": [
          "Cero secretos hardcodeados en cÃ³digo o workflows.",
          "RLS verificada por pruebas automatizadas antes de releases.",
          "Alertas de seguridad documentadas y atendidas en menos de 24 horas."
        ],
        "puntos_de_colaboracion": [
          "Validar con Arquitectura de Software el diseÃ±o seguro de nuevas features.",
          "AcompaÃ±ar a Automatizaciones n8n en el manejo de errores y registros sensibles.",
          "Definir con Commits y Estructura polÃ­ticas de revisiÃ³n y firmas de commits cuando aplique."
        ]
      },
      "arquitecto_automatizaciones_n8n": {
        "objetivo": "Garantizar workflows n8n resilientes, observables y fÃ¡cilmente extensibles para nuevas automatizaciones.",
        "responsabilidades_clave": [
          "Versionar y documentar cada workflow (inputs, outputs, tiempos de ejecuciÃ³n y SLAs).",
          "DiseÃ±ar estrategias de reintentos, manejo de errores y fallback a cache o supabase.",
          "Integrar nuevas APIs (alertas, notificaciones) con validaciones y pruebas end-to-end.",
          "Monitorear el rendimiento de n8n (tiempos, colas, uso de recursos) y ajustar triggers.",
          "Mantener librerÃ­a de nodos reutilizables (JS Code, HTTP Request, Supabase) con buenas prÃ¡cticas."
        ],
        "entregables_recurrentes": [
          "CatÃ¡logo actualizado de workflows y endpoints expuestos.",
          "Plantillas n8n para errores controlados y notificaciones.",
          "Dashboard de mÃ©tricas clave (tiempo medio de respuesta, errores, reintentos).",
          "Playbook de despliegue y rollback de workflows."
        ],
        "herramientas_y_fuentes": [
          "n8n Editor",
          "Supabase SQL y Storage",
          "Postman o Insomnia",
          "Sentry o Logflare para observabilidad"
        ],
        "criterios_de_finalizado": [
          "Tiempo medio de respuesta menor a 2 segundos en endpoints crÃ­ticos.",
          "Errores controlados con reintentos documentados (al menos 95 % recuperables).",
          "DocumentaciÃ³n sincronizada con context.json tras cada cambio mayor."
        ],
        "puntos_de_colaboracion": [
          "Alinear con Arquitectura de Software contratos de datos y caching.",
          "Trabajar con Ciberseguridad en manejo seguro de tokens y logs.",
          "Apoyar a Commits y Estructura en versionado y backups de workflows."
        ]
      },
      "agente_commits_y_estructura": {
        "objetivo": "Mantener el repositorio ordenado, con historial de cambios claro y carpetas coherentes con la arquitectura.",
        "responsabilidades_clave": [
          "Supervisar el cumplimiento de Conventional Commits y naming de ramas.",
          "Automatizar linters, pruebas rÃ¡pidas y validaciones antes de cada commit o PR.",
          "Curar la estructura de carpetas (alta cohesiÃ³n, baja duplicidad) y archivar documentaciÃ³n obsoleta.",
          "Generar changelog y notas de versiÃ³n para cada release beta o estable.",
          "Asegurar que context.json y documentos relevantes se actualicen con cada cambio mayor."
        ],
        "entregables_recurrentes": [
          "GuÃ­a viva de ramas y flujo de trabajo.",
          "Scripts de verificaciÃ³n (lint, test, build) y plantillas de PR.",
          "Changelog versionado y matriz de dependencias actualizada.",
          "Reporte quincenal de limpieza de carpetas y archivos huÃ©rfanos."
        ],
        "herramientas_y_fuentes": [
          "Git y Git Flow",
          "Husky o lint-staged",
          "ESLint y Prettier",
          "tree o madge para auditorÃ­a de dependencias"
        ],
        "criterios_de_finalizado": [
          "Commits sin errores de formato y con scope correcto.",
          "Repositorio sin archivos huÃ©rfanos ni duplicados despuÃ©s de cada iteraciÃ³n.",
          "DocumentaciÃ³n sincronizada con los releases publicados."
        ],
        "puntos_de_colaboracion": [
          "Sincronizar con Arquitectura de Software los cambios estructurales.",
          "Incluir checklist de seguridad acordado con Ciberseguridad antes de mergear.",
          "Versionar y respaldar workflows definidos por Automatizaciones n8n."
        ]
      }
    },
    "ritmos_de_colaboracion": {
      "daily_async": "ActualizaciÃ³n breve en canal compartido destacando avance, bloqueos y dependencias por agente.",
      "reunion_semanal": "SesiÃ³n de 60 minutos para revisar mÃ©tricas (performance, seguridad, SLA n8n, higiene de repositorio) y priorizar backlog.",
      "revision_pre_release": "Checklist coordinado 48 horas antes de cada release beta: arquitectura valida integraciones, ciberseguridad aprueba riesgos, automatizaciones valida workflows y commits y estructura cierra changelog.",
      "retro_mensual": "Espacio para documentar aprendizajes, deuda tÃ©cnica y ajustes al proceso de colaboraciÃ³n."
    },
    "tablero_de_seguimiento": {
      "formato": "Kanban compartido (Notion o Jira) con columnas Idea -> DiseÃ±o -> ImplementaciÃ³n -> ValidaciÃ³n -> Listo.",
      "metricas_por_agente": {
        "arquitecto_software": [
          "NÃºmero de ADR aprobados",
          "Componentes crÃ­ticos sin regresiones de performance"
        ],
        "especialista_ciberseguridad": [
          "Incidentes abiertos versus resueltos",
          "Cobertura de RLS y escaneos automÃ¡ticos"
        ],
        "arquitecto_automatizaciones_n8n": [
          "SLA por workflow",
          "Errores recuperados versus fatales"
        ],
        "agente_commits_y_estructura": [
          "Commits que pasan validaciones automÃ¡ticas",
          "NÃºmero de archivos huÃ©rfanos detectados"
        ]
      }
    }
  },
  "modo_de_ayuda_deseado": {
    "rol_del_agente": "Especialista en arquitectura de aplicaciones moviles con enfoque pedagÃ³gico y riguroso.",
    "estilo_del_agente": [
      "Explicar el 'por quÃ©' de cada decisiÃ³n tÃ©cnica",
      "Mostrar pros y contras de cada implementaciÃ³n",
      "Adaptar el lenguaje a nivel intermedio de desarrollo mÃ³vil",
      "Priorizar soluciones escalables y mantenibles",
      "Enfocarse en mejores prÃ¡cticas de React Native y TypeScript",
      "Considerar performance mÃ³vil y UX en todas las decisiones"
    ]
  },
  "restricciones_y_consideraciones": [
    "Usar n8n como backend (no backend tradicional)",
    "Mantener compatibilidad con Expo SDK 54",
    "Priorizar performance en dispositivos moviles",
    "Mantener codigo limpio y documentado",
    "Evitar dependencias innecesarias",
    "Seguir principios de mobile-first design",
    "Implementar buenas prÃ¡cticas de TypeScript",
    "Mantener compatibilidad con iOS y Android"
  ],
  "estadisticas_proyecto": {
    "lineas_codigo": "~8000+ lÃ­neas",
    "archivos_typescript": "30 archivos confirmados",
    "componentes_react": "22+ componentes",
    "pantallas": "7 pantallas (5 integradas, 2 pendientes)",
    "servicios": "6 servicios implementados (incluye cartService)",
    "hooks_personalizados": "2 custom hooks (useCart, useProductModal eliminado)",
    "workflows_n8n": "5 workflows activos + 1 endpoint adicional (search-in-db)",
    "cobertura_funcional": "95% de funcionalidades core implementadas",
    "tiempo_desarrollo": "3+ meses de desarrollo activo",
    "console_logs": "250+ logs activos (debug mode)",
    "uso_de_any": "7 ocurrencias (mayormente en n8n response handling)",
    "dependencias_instaladas": [
      "@react-navigation/native v7.1.17",
      "@react-navigation/bottom-tabs v7.4.7",
      "@react-navigation/stack v7.4.8",
      "@supabase/supabase-js v2.57.0",
      "expo-secure-store v15.0.7",
      "react-native-safe-area-context v5.6.0",
      "expo v54.0.23",
      "react v19.1.0",
      "react-native v0.81.5"
    ],
    "dependencias_pendientes": [
      "@react-native-async-storage/async-storage",
      "zod"
    ]
  },
  "auditoria_enero_2025": {
    "fecha": "Enero 2025",
    "hallazgos_principales": [
      "âœ… ErrorBoundary implementado correctamente",
      "âœ… Historial de precios: servicio funcional, pendiente integraciÃ³n UI",
      "âœ… Sistema de alertas: servicio funcional, pendiente integraciÃ³n UI",
      "âœ… ConfiguraciÃ³n por ambiente implementada",
      "âœ… React Navigation actualizado a v7",
      "âš ï¸ AlertsScreen y HistoryScreen existen pero no estÃ¡n en navegaciÃ³n",
      "âš ï¸ AsyncStorage y Zod mencionados pero no instalados",
      "âš ï¸ Estructura duplicada detectada (ScrapMarketApp/ScrapMarketApp/)",
      "âœ… 25 archivos TypeScript/TSX confirmados",
      "âœ… NavegaciÃ³n con Bottom Tabs + Stack Navigator funcionando"
    ],
    "recomendaciones": [
      "Integrar AlertsScreen y HistoryScreen en AppNavigator",
      "Instalar @react-native-async-storage/async-storage",
      "Instalar zod para validaciÃ³n de esquemas",
      "Limpiar estructura de carpetas duplicada",
      "Considerar migrar a Redux Toolkit para estado global",
      "Implementar notificaciones push para alertas"
    ]
  },
  "auditoria_noviembre_2025": {
    "fecha": "12 Noviembre 2025",
    "resumen": "AuditorÃ­a completa post-implementaciÃ³n de carrito de compras y mejoras de UX",
    "hallazgos_principales": {
      "arquitectura": [
        "âœ… Carrito de compras completamente implementado",
        "âœ… Sistema de observers/listeners para reactividad implementado",
        "âœ… NavegaciÃ³n actualizada con tab de Cart",
        "âœ… Custom hooks implementados (useCart)",
        "âœ… Modales personalizados reemplazan Alert nativo",
        "âš ï¸ Estructura duplicada persiste (ScrapMarketApp/ScrapMarketApp/)",
        "âš ï¸ 250+ console.log activos en desarrollo"
      ],
      "calidad_codigo": [
        "âœ… TypeScript strict mode activo",
        "âœ… 30 archivos TypeScript/TSX",
        "âœ… Interfaces bien definidas",
        "âœ… SeparaciÃ³n de responsabilidades clara",
        "âš ï¸ 7 ocurrencias de 'any' type",
        "âš ï¸ Algunos archivos >800 lÃ­neas (SearchScreen.tsx)",
        "âš ï¸ Falta configuraciÃ³n de ESLint/Prettier"
      ],
      "seguridad": [
        "âœ… expo-secure-store instalado",
        "âœ… ConfiguraciÃ³n por ambiente",
        "âš ï¸ URLs y endpoints hardcodeados en algunos lugares",
        "âš ï¸ No hay rate limiting en frontend",
        "âš ï¸ Falta validaciÃ³n estricta con Zod"
      ],
      "performance": [
        "âœ… Skeleton loading implementado",
        "âœ… Pull-to-refresh nativo",
        "âœ… Animaciones optimizadas (Animated API)",
        "âœ… Lifecycle management en carousel",
        "âš ï¸ 250+ console.log impactan performance",
        "âš ï¸ No hay memoization en componentes grandes",
        "âš ï¸ Falta virtualization en listas largas"
      ],
      "ux_ui": [
        "âœ… Modales personalizados con mejor UX",
        "âœ… Badge animado del carrito",
        "âœ… Controles de cantidad intuitivos",
        "âœ… CapitalizaciÃ³n correcta de marcas",
        "âœ… Manejo de estados vacÃ­os",
        "âœ… Indicadores de carga apropiados",
        "âš ï¸ Falta feedback hÃ¡ptico en interacciones"
      ],
      "integracion_backend": [
        "âœ… addToCartLink correctamente integrado desde BD",
        "âœ… seller_name y seller_id manejados correctamente",
        "âœ… Queries SQL optimizadas para popular_products",
        "âœ… n8n workflows actualizados",
        "âœ… Manejo robusto de mÃºltiples formatos JSON",
        "âœ… search-in-db endpoint funcional",
        "âš ï¸ Falta manejo de rate limiting en API calls"
      ]
    },
    "metricas": {
      "cobertura_funcional": "95%",
      "deuda_tecnica": "Media (principalmente logs y estructura duplicada)",
      "mantenibilidad": "Alta (cÃ³digo bien organizado)",
      "escalabilidad": "Media (pendiente Redux Toolkit)",
      "seguridad": "Media (pendiente validaciones estrictas)"
    },
    "recomendaciones_prioritarias": [
      "ğŸ”´ ALTA: Limpiar console.log para producciÃ³n o implementar logger condicional",
      "ğŸ”´ ALTA: Implementar AsyncStorage para persistencia del carrito",
      "ğŸ”´ ALTA: Limpiar estructura duplicada (ScrapMarketApp/ScrapMarketApp/)",
      "ğŸŸ¡ MEDIA: Instalar y configurar Zod para validaciÃ³n de esquemas",
      "ğŸŸ¡ MEDIA: Implementar React.memo en componentes pesados (SearchScreen, PopularProducts)",
      "ğŸŸ¡ MEDIA: Configurar ESLint y Prettier para consistencia de cÃ³digo",
      "ğŸŸ¡ MEDIA: Reducir ocurrencias de 'any' type (actualmente 7)",
      "ğŸŸ¢ BAJA: Agregar feedback hÃ¡ptico en interacciones clave",
      "ğŸŸ¢ BAJA: Implementar virtualization en listas largas (FlatList windowSize)",
      "ğŸŸ¢ BAJA: Extraer constantes hardcodeadas a archivos de configuraciÃ³n"
    ],
    "proximos_pasos_sugeridos": [
      "1. Crear configuraciÃ³n de logger con flag de desarrollo",
      "2. Implementar persistencia del carrito con AsyncStorage",
      "3. Limpiar estructura de carpetas duplicada",
      "4. Instalar y configurar Zod para validaciÃ³n",
      "5. Agregar React.memo a componentes crÃ­ticos",
      "6. Configurar ESLint con reglas recomendadas de React Native",
      "7. Implementar tests unitarios para servicios crÃ­ticos (cartService, searchService)",
      "8. Documentar API contracts entre frontend y n8n",
      "9. Considerar migraciÃ³n a Redux Toolkit para estado global",
      "10. Preparar para integraciÃ³n de AlertsScreen y HistoryScreen"
    ],
    "conclusiones": [
      "El proyecto estÃ¡ en excelente estado funcional con 95% de features implementadas",
      "La arquitectura es sÃ³lida y escalable, con buena separaciÃ³n de responsabilidades",
      "El carrito de compras estÃ¡ completamente funcional con excelente UX",
      "La integraciÃ³n con n8n y Supabase es robusta y maneja mÃºltiples casos edge",
      "La deuda tÃ©cnica es manejable y principalmente cosmÃ©tica (logs, estructura)",
      "Recomendable continuar con implementaciÃ³n de features pendientes (Alerts, History)",
      "El cÃ³digo estÃ¡ listo para testing mÃ¡s riguroso y eventual deployment beta"
    ]
  }
}
